---
title: The lifecycle of effect hooks in React
order: 100
category: hook
isHidden: true
---

## useEffect ë³µìŠµ

ReactëŠ” ì„¤ì • í•¨ìˆ˜ì™€ ì •ë¦¬ í•¨ìˆ˜ê°€ í•„ìš”í•  ë•Œë§ˆë‹¤ í˜¸ì¶œí•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. ì»´í¬ë„ŒíŠ¸ê°€ í™”ë©´ì— ì¶”ê°€ë˜ì—ˆì„ ë•Œ ì„¤ì • ì½”ë“œê°€ ë™ì‘í•©ë‹ˆë‹¤ (ë§ˆìš´íŠ¸ ì‹œ).
1. ì˜ì¡´ì„±ì´ ë³€ê²½ëœ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ ë  ë•Œë§ˆë‹¤ ì•„ë˜ ë™ì‘ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ë¨¼ì € ì •ë¦¬ ì½”ë“œê°€ ì˜¤ë˜ëœ propsì™€ stateì™€ í•¨ê»˜ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´í›„, ì„¤ì • ì½”ë“œê°€ ìƒˆë¡œìš´ propsì™€ stateì™€ í•¨ê»˜ ì‹¤í–‰ë©ë‹ˆë‹¤.
1. ì»´í¬ë„ŒíŠ¸ê°€ í™”ë©´ì—ì„œ ì œê±°ëœ ì´í›„ì— ì •ë¦¬ ì½”ë“œê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤ (ë§ˆìš´íŠ¸ í•´ì œ ì‹œ).

## í›… ë³µìŠµ

> A hook is something attached to a fiber.

## êµ¬ì¡°

- flushPassiveEffects
  - **commitPassiveUnmountEffects**
    - commitPassiveUnmountEffects_begin
      - commitPassiveUnmountEffectsInsideOfDeletedTree_begin
      - commitPassiveUnmountEffects_complete
        - commitPassiveUnmountOnFiber
  - **commitPassiveMountEffects**
    - commitHookEffectListMount

## commitPassiveUnmountEffects_begin 

```js
function commitPassiveUnmountEffects_begin() {
  while (nextEffect !== null) {
    const fiber = nextEffect;
    const child = fiber.child;
    if ((nextEffect.flags & ChildDeletion) !== NoFlags) {
      const deletions = fiber.deletions;
      if (deletions !== null) {
        // nextEffectë¥¼ ì‚­ì œí•  Fiberë¡œ ë³€ê²½í•˜ê³  
        // ê° Fiberì— ëŒ€í•´ commitPassiveUnmountEffectsInsideOfDeletedTree_begin í˜¸ì¶œ
        if (deletedTreeCleanUpLevel >= 1) {
          // A fiber was deleted from this parent fiber, but it's still part of
          // the previous (alternate) parent fiber's list of children. Because
          // children are a linked list, an earlier sibling that's still alive
          // will be connected to the deleted fiber via its `alternate`:
          //
          //   live fiber
          //   --alternate--> previous live fiber
          //   --sibling--> deleted fiber
          //
          // We can't disconnect `alternate` on nodes that haven't been deleted
          // yet, but we can disconnect the `sibling` and `child` pointers.
          const previousFiber = fiber.alternate;
          if (previousFiber !== null) {
            let detachedChild = previousFiber.child;
            if (detachedChild !== null) {
              previousFiber.child = null;
              do {
                const detachedSibling = detachedChild.sibling;
                detachedChild.sibling = null;
                detachedChild = detachedSibling;
              } while (detachedChild !== null);
            }
          }
        }
        nextEffect = fiber;
      }
    }
    if ((fiber.subtreeFlags & PassiveMask) !== NoFlags && child !== null) {
      ensureCorrectReturnPointer(child, fiber);
      nextEffect = child;
    } else {
      commitPassiveUnmountEffects_complete();
    }
  }
}
```

Reactì˜ Fiber ì•„í‚¤í…ì²˜ëŠ” ë‘ ê°œì˜ íŠ¸ë¦¬(currentì™€ alternate)ë¥¼ ë²ˆê°ˆì•„ ì¬ì‚¬ìš©í•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.
	â€¢	current: í˜„ì¬ í™”ë©´ì— ë Œë”ë§ëœ íŠ¸ë¦¬
	â€¢	alternate: ë‹¤ìŒ ë Œë”ë¥¼ ì¤€ë¹„í•˜ëŠ” ì‘ì—… íŠ¸ë¦¬ (workInProgress)

ë Œë”ë§ì´ ì™„ë£Œë˜ë©´ ë‘ íŠ¸ë¦¬ì˜ ì—­í• ì´ ì„œë¡œ êµì²´ë©ë‹ˆë‹¤.

ì‚­ì œëœ ì»´í¬ë„ŒíŠ¸(Fiber)ëŠ” alternate íŠ¸ë¦¬ì— ì—¬ì „íˆ ì—°ê²°ëœ ìƒíƒœë¡œ ë‚¨ì•„ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```
live fiber
 â””â”€ alternate â†’ previous fiber
                      â””â”€ sibling â†’ deleted fiber
```

ì´ ìƒíƒœì—ì„œ ë¬¸ì œê°€ ë˜ëŠ” ì´ìœ :
- alternateëŠ” ë‹¤ìŒ ë Œë”ë§ì—ì„œ ì¬ì‚¬ìš©ë¨
- ì‚­ì œëœ Fiberê°€ ì—°ê²°ëœ ì±„ë¡œ ë‚¨ì•„ ìˆìœ¼ë©´
- Reactê°€ ê·¸ê²ƒì„ ë‹¤ì‹œ ì‚´ì•„ìˆëŠ” ê²ƒìœ¼ë¡œ ì°©ê°í•  ìˆ˜ ìˆìŒ
- ë¶ˆí•„ìš”í•œ effect í˜¸ì¶œ, ë©”ëª¨ë¦¬ ì ‘ê·¼, í¬ë˜ì‹œ ê°€ëŠ¥ì„± ë°œìƒ

ë”°ë¼ì„œ passive effect(unmount clean-up) ë‹¨ê³„ì—ì„œ:
	â€¢	alternate.child, sibling í¬ì¸í„°ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ëŠì–´ì¤Œ
	â€¢	ë‹¤ìŒ ë Œë”ë§ ì‹œ ì•ˆì „í•˜ê²Œ workInProgressë¡œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì •ë¦¬í•¨


ğŸ‘‰ ì •ë¦¬:
ì‚­ì œëœ Fiberë¥¼ í¬í•¨í•œ alternate íŠ¸ë¦¬ì˜ ì—°ê²°ì„ ì •ë¦¬(clean-up)í•˜ëŠ” ê²ƒì€
Reactì˜ ë Œë”ë§ ì¼ê´€ì„±ê³¼ ë©”ëª¨ë¦¬ ì•ˆì „ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•œ í•„ìˆ˜ ì‘ì—…ì…ë‹ˆë‹¤.

## commitPassiveUnmountEffectsInsideOfDeletedTree_begin

```js
function commitPassiveUnmountEffectsInsideOfDeletedTree_begin(
  deletedSubtreeRoot: Fiber,
  nearestMountedAncestor: Fiber | null,
) {
  while (nextEffect !== null) {
    const fiber = nextEffect;

    // Deletion effects fire in parent -> child order
    // ì´í›„ ì–´ì°Œì–´ì°Œí•´ì„œ safelyCallDestroy í˜¸ì¶œ
    // ë³„ê±° ì—†ê³  catchë¬¸ìœ¼ë¡œ ê°ì‹¸ì„œ 'safely'ì´ë‹¤.
    commitPassiveUnmountInsideDeletedTreeOnFiber(fiber, nearestMountedAncestor);

    const child = fiber.child;
    if (child !== null) {
      // [!code highlight]
      // returnì€ ì™œ?
      child.return = fiber;
      nextEffect = child;
    } else {
      commitPassiveUnmountEffectsInsideOfDeletedTree_complete(
        deletedSubtreeRoot,
      );
    }
  }
}
```

