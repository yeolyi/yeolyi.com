---
import { Button } from "@/components/ui/button";
import { Separator } from "@/components/ui/separator";
---

<div class="space-y-6 border p-6">
  <!-- 1. 헤더 영역 -->
  <div class="flex items-center justify-between">
    <h3 class="m-0 text-lg font-bold">성열굿즈샵</h3>
    <span class="text-sm"
      >장바구니: <span id="header-cart-count" class="font-bold">0</span></span
    >
  </div>

  <Separator />

  <!-- 2. 상품 목록 페이지 -->
  <div>
    <h3 class="m-0 mb-4 text-lg font-bold">상품 목록</h3>
    <div class="flex items-center justify-between">
      <div>
        <p class="m-0 font-semibold">나는 개발이 싫어요 티셔츠</p>
        <p class="m-0 text-sm text-gray-500">30,000원</p>
      </div>
      <Button id="add-to-cart-btn">장바구니 담기</Button>
    </div>
  </div>

  <Separator />

  <!-- 3. 장바구니 페이지 -->
  <div>
    <h3 class="m-0 mb-2 text-lg font-bold">장바구니 페이지</h3>
    <div id="empty-cart-message" class="py-4 text-center text-gray-500">
      장바구니가 비어있습니다.
    </div>
    <div id="cart-summary" style="display: none;" class="space-y-2">
      <p id="cart-total-items" class="m-0">총 0개 상품</p>

      <div class="flex justify-between text-sm">
        <span>배송비:</span>
        <span id="shipping-fee">3,000원</span>
      </div>
      <div
        id="free-shipping-notice"
        style="display: none;"
        class="text-sm text-green-600"
      >
        🎉 5만원 이상 구매 시 무료배송!
      </div>

      <Separator className="my-2" />

      <div class="flex justify-between font-bold">
        <span>총 주문금액:</span>
        <span id="total-price">0원</span>
      </div>
    </div>
  </div>
</div>

<script>
  // 상태 변수
  let cartCount = 0;
  let totalPrice = 0;
  const itemPrice = 30000;

  // DOM 요소
  const addToCartBtn = document.getElementById("add-to-cart-btn");
  const headerCartCount = document.getElementById("header-cart-count");
  const cartTotalItems = document.getElementById("cart-total-items");
  const totalPriceEl = document.getElementById("total-price");
  const shippingFeeEl = document.getElementById("shipping-fee");
  const freeShippingNotice = document.getElementById("free-shipping-notice");
  const emptyCartMessage = document.getElementById("empty-cart-message");
  const checkoutButton = document.getElementById("checkout-button");
  const cartSummary = document.getElementById("cart-summary");

  // 상태를 업데이트하고 UI에 반영하는 함수
  function addToCart(price) {
    cartCount++;
    totalPrice += price;

    // 헤더의 장바구니 아이콘 옆 숫자 업데이트
    if (headerCartCount) {
      headerCartCount.textContent = cartCount.toString();
    }

    // 장바구니 페이지의 총 상품 수 업데이트
    if (cartTotalItems) {
      cartTotalItems.textContent = `총 ${cartCount}개 상품`;
    }

    // 총 금액 업데이트
    if (totalPriceEl) {
      totalPriceEl.textContent = `${totalPrice.toLocaleString()}원`;
    }

    // 무료배송 조건 체크 (5만원 이상)
    if (totalPrice >= 50000) {
      if (shippingFeeEl) shippingFeeEl.textContent = "무료";
      if (freeShippingNotice) freeShippingNotice.style.display = "block";
    }

    // 빈 장바구니 메시지 숨기기 및 관련 UI 업데이트
    if (cartCount > 0) {
      if (emptyCartMessage) emptyCartMessage.style.display = "none";
      if (cartSummary) cartSummary.style.display = "block";
    }
  }

  // 버튼에 클릭 이벤트 리스너 추가
  if (addToCartBtn) {
    addToCartBtn.addEventListener("click", () => addToCart(itemPrice));
  }
</script>
