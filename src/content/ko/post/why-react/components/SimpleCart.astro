---
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Separator } from "@/components/ui/separator";
---

<Card client:load>
  <CardHeader>
    <h2 class="text-xl font-bold">ì„±ì—´êµ¿ì¦ˆìƒµğŸ›ï¸</h2>
  </CardHeader>
  <Separator />
  <CardHeader>
    <CardTitle>ìƒí’ˆ ëª©ë¡</CardTitle>
  </CardHeader>
  <CardContent>
    <div id="products-simple" class="flex flex-col gap-4">
      <div class="flex items-center justify-between" data-product-name="ìƒí’ˆ A">
        <p>ìƒí’ˆ A</p>
        <Button id="toggle-cart-btn-simple">ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€</Button>
      </div>
    </div>
  </CardContent>
  <CardHeader>
    <CardTitle>ì¥ë°”êµ¬ë‹ˆ</CardTitle>
  </CardHeader>
  <CardContent>
    <ul id="cart-items-simple" class="list-disc pl-5">
      <!-- ì¥ë°”êµ¬ë‹ˆ í•­ëª©ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
    </ul>
  </CardContent>
</Card>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const toggleBtn = document.getElementById(
      "toggle-cart-btn-simple",
    ) as HTMLButtonElement;
    const cartItemsList = document.getElementById("cart-items-simple");
    const productElement = document.querySelector("[data-product-name]");
    const productName = (productElement as HTMLElement)?.dataset.productName;

    if (!toggleBtn || !cartItemsList || !productName) return;

    if (toggleBtn.dataset.listenerAttached) return;
    toggleBtn.dataset.listenerAttached = "true";

    let isInCart = false;

    toggleBtn.addEventListener("click", () => {
      if (isInCart) {
        // Remove from cart
        const itemToRemove = Array.from(cartItemsList.children).find(
          (item) => item.textContent === productName,
        );
        if (itemToRemove) {
          cartItemsList.removeChild(itemToRemove);
        }
        toggleBtn.textContent = "ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€";
        isInCart = false;
      } else {
        // Add to cart
        const cartItem = document.createElement("li");
        cartItem.textContent = productName;
        cartItemsList.appendChild(cartItem);
        toggleBtn.textContent = "ì œê±°";
        isInCart = true;
      }
    });
  });
</script>
